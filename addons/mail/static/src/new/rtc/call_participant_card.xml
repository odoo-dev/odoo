<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="mail.call_participant_card" owl="1">
        <div class="o-mail-call-participant-card position-relative cursor-pointer d-flex flex-column align-items-center justify-content-center mh-100 mw-100 p-1 rounded-1"
            t-att-class="{
                'o-isTalking': !isMinimized and isTalking,
                'o-isInvitation opacity-50': !props.session,
            }"
            t-att-title="name"
            t-att-aria-label="name"
            t-attf-class="{{ props.className }}"
            t-on-click="onClick"
            t-on-contextmenu="onContextMenu"
            t-ref="root"
        >
            <!-- card -->
            <CallParticipantVideo t-if="hasVideo" session="props.session"/>
            <div t-else="" class="o-mail-call-participant-card-avatarFrame d-flex align-items-center justify-content-center h-100 w-100 rounded-1" t-att-class="{ 'o-isMinimized': isMinimized }" draggable="false">
                <img alt="Avatar"
                        t-att-class="{
                        'o-isTalking': isTalking,
                        'o-isInvitation': !props.session,
                        }"
                        class="o-mail-call-participant-card-avatarImage h-100 rounded-circle border-5 o_object_fit_cover"
                        t-att-src="avatarUrl"
                        draggable="false"
                />
            </div>
            <t t-if="props.session">
                <!-- overlay -->
                <span class="o-mail-call-participant-card-overlay o-mail-call-participant-card-overlayBottom position-absolute bottom-0 start-0 d-flex overflow-hidden">
                    <span t-if="!isMinimized" class="o-mail-call-participant-card-name p-1 rounded-1 bg-black-75 text-truncate" t-esc="name"/>
                    <small t-if="props.session.isScreenSharingOn and isMinimized and !isOfActiveCall" class="o-mail-call-participant-card-liveIndicator o-isMinimized rounded-pill text-bg-danger d-flex align-items-center fw-bolder" title="live" aria-label="live">
                        LIVE
                    </small>
                </span>
                <div class="o-mail-call-participant-card-overlay o-mail-call-participant-card-overlayTop position-absolute top-0 end-0 d-flex flex-row-reverse">
                    <span t-if="props.session.isSelfMuted and !props.session.isDeaf" class="o-mail-call-participant-card-overlayTopElement d-flex flex-column justify-content-center me-1 rounded-circle bg-900" t-att-class="{'o-isMinimized p-1': isMinimized, 'p-2': !isMinimized }" title="muted" aria-label="muted">
                        <i class="fa fa-microphone-slash"/>
                    </span>
                    <span t-if="props.session.isDeaf" class="o-mail-call-participant-card-overlayTopElement d-flex flex-column justify-content-center me-1 rounded-circle bg-900" t-att-class="{'o-isMinimized p-1': isMinimized, 'p-2': !isMinimized }" title="deaf" aria-label="deaf">
                        <i class="fa fa-deaf"/>
                    </span>
                    <span t-if="isOfActiveCall and props.session.isAudioInError" class="o-mail-call-participant-card-overlayTopElement d-flex flex-column justify-content-center me-1 p-2 rounded-circle bg-900 text-danger" title="Issue with audio">
                        <i class="fa fa-exclamation-triangle"/>
                    </span>
                    <span t-if="showConnectionState" class="o-mail-call-participant-card-overlayTopElement d-flex flex-column justify-content-center me-1 p-2 rounded-circle bg-900" t-att-title="props.session.connectionState">
                        <i class="fa fa-exclamation-triangle o-mail-call-participant-card-connectionState text-warning"/>
                    </span>
                    <span t-if="props.session.isScreenSharingOn and !isMinimized and !isOfActiveCall" class="o-mail-call-participant-card-liveIndicator rounded-pill text-bg-danger d-flex align-items-center me-1 fw-bolder" title="live" aria-label="live">
                        LIVE
                    </span>
                </div>

                <!-- volume popover -->
                <i t-if="!props.session === rtc.state.selfSession" class="o-mail-call-participant-card-volumeMenuAnchor position-absolute bottom-0 start-50" t-on-click="onClickVolumeAnchor" t-ref="volumeMenuAnchor"/>
            </t>
        </div>
    </t>

</templates>
