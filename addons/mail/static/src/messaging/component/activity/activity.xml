<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="mail.component.Activity" owl="1">
        <div class="o_Activity">
            <div class="o_Activity_sidebar">
                <div class="o_Activity_user">
                    <img class="o_Activity_userAvatar"
                         t-attf-src="/web/image{{ storeProps.activity.userId >= 0 ? ('/res.users/' + storeProps.activity.userId + '/image_128') : '' }}"
                         t-att-alt="storeProps.activity.userDisplayName"/>
                    <i class="o_Activity_icon fa" t-att-class="{
                        'bg-success-full': storeProps.activity.activityState === 'planned',
                        'bg-warning-full': storeProps.activity.activityState === 'today',
                        'bg-danger-full': storeProps.activity.activityState === 'overdue',
                    }" t-attf-class="{{ storeProps.activity.icon }}"/>
                </div>
            </div>
            <div class="o_Activity_core">
                <div class="o_Activity_info">
                    <div class="o_Activity_dueDateText"
                          t-att-class="{
                            'o-default': storeProps.activity.activityState === 'default',
                            'o-overdue': storeProps.activity.activityState === 'overdue',
                            'o-planned': storeProps.activity.activityState === 'planned',
                            'o-today': storeProps.activity.activityState === 'today',
                          }"
                    >
                        <t t-esc="delayLabel"/>
                    </div>
                    <t t-if="storeProps.activity.summary">
                        <div class="o_Activity_summary">
                            <t t-esc="summary"/>
                        </div>
                    </t>
                    <t t-else="">
                        <div class="o_Activity_summary o_Activity_type">
                            <t t-esc="storeProps.activity.activityTypeDisplayName"/>
                        </div>
                    </t>
                    <div class="o_Activity_userName">
                        <t t-esc="assignedUserText"/>
                    </div>
                    <a class="o_Activity_detailsButton btn btn-link" t-on-click="_onClickDetailsButton" role="button">
                        <i class="fa fa-info-circle" role="img" title="Info" aria-label="Info"/>
                    </a>
                </div>

                <div class="o_Activity_details" t-if="state.areDetailsVisible">
                    <dl class="dl-horizontal">
                        <dt>Activity type</dt>
                        <dd class="o_Activity_type">
                            <t t-esc="storeProps.activity.activityTypeDisplayName"/>
                        </dd>
                        <dt>Created</dt>
                        <dd class="o_Activity_detailsCreation">
                            <t t-esc="formattedCreateDatetime"/>
                            <img class="o_Activity_detailsUserAvatar o_Activity_detailsCreatorAvatar"
                                 t-attf-src="/web/image{{ storeProps.activity.creatorId >= 0 ? ('/res.users/' + storeProps.activity.creatorId + '/image_128') : '' }}"
                                 t-att-title="storeProps.activity.creatorDisplayName"
                                 t-att-alt="storeProps.activity.creatorDisplayName"/>
                            <span class="o_Activity_detailsCreator">
                                <t t-esc="storeProps.activity.creatorDisplayName"/>
                            </span>
                        </dd>
                        <dt>Assigned to</dt>
                        <dd class="o_Activity_detailsAssignation">
                            <img class="o_Activity_detailsUserAvatar o_Activity_detailsAssignationUserAvatar"
                                 t-attf-src="/web/image{{ storeProps.activity.userId >= 0 ? ('/res.users/' + storeProps.activity.userId + '/image_128') : '' }}"
                                 t-att-title="storeProps.activity.userDisplayName"
                                 t-att-alt="storeProps.activity.userDisplayName"/>
                            <t t-esc="storeProps.activity.userDisplayName"/>
                        </dd>
                        <dt>Due on</dt>
                        <dd class="o_Activity_detailsDueDate">
                            <span class="o_Activity_deadlineDateText"
                                  t-att-class="{
                                    'o-default': storeProps.activity.activityState === 'default',
                                    'o-overdue': storeProps.activity.activityState === 'overdue',
                                    'o-planned': storeProps.activity.activityState === 'planned',
                                    'o-today': storeProps.activity.activityState === 'today',
                                  }">
                                <t t-esc="formattedDeadlineDate"/>
                            </span>
                        </dd>
                    </dl>
                </div>

                <div class="o_Activity_note" t-if="storeProps.activity.note">
                    <t t-raw="storeProps.activity.note"/>
                </div>

                <t t-if="storeProps.activity.mailTemplateLocalIds.length > 0">
                    <div class="o_Activity_mailTemplates">
                        <t t-foreach="storeProps.activity.mailTemplateLocalIds" t-as="mailTemplateLocalId" t-key="mailTemplateLocalId">
                            <MailTemplate class="o_Activity_mailTemplate"
                                activityLocalId="props.activityLocalId"
                                mailTemplateLocalId="mailTemplateLocalId"/>
                        </t>
                    </div>
                </t>

                <t t-if="storeProps.activity.canWrite">
                    <div class="o_Activity_tools">
                        <t t-if="storeProps.activity.activityCategory !== 'upload_file'">
                            <ActivityMarkDoneButton class="o_Activity_toolButton o_Activity_markDoneButton btn-link"
                                activityLocalId="props.activityLocalId"
                                popoverTitle="'Mark Done'"
                            >
                                <t t-set="buttonHtml">
                                    <i class="fa fa-check"/>
                                    Mark Done
                                </t>
                            </ActivityMarkDoneButton>
                        </t>
                        <t t-else="">
                            <button class="o_Activity_toolButton o_Activity_uploadButton btn btn-link"
                                    t-on-click="_onClickUploadDocument">
                                <i class="fa fa-upload"/>
                                Upload Document
                            </button>
                            <FileUploader
                                attachmentLocalIds="storeProps.activity.attachmentLocalIds"
                                uploadId="storeProps.activity.resId"
                                uploadModel="storeProps.activity.model"
                                t-on-o-attachment-created="_onAttachmentCreated"
                                t-ref="fileUploader"
                            />
                        </t>
                        <button class="o_Activity_toolButton o_Activity_editButton btn btn-link"
                                t-on-click="_onClickEdit">
                            <i class="fa fa-pencil"/>
                            Edit
                        </button>
                        <button class="o_Activity_toolButton o_Activity_cancelButton btn btn-link"
                                t-on-click="_onClickCancel">
                            <i class="fa fa-times"/>
                            Cancel
                        </button>
                    </div>
                </t>
            </div>
        </div>
    </t>

</templates>
