<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="mail.messaging.component.ChatWindowManager" owl="1">
        <div class="o_ChatWindowManager">
            <!-- Note: DOM elements are ordered from left to right -->
            <t t-if="storeProps.computed.hidden.isVisible">
                <!-- TODO FIXME _onCloseChatWindow is not defined in ChatWindowManager -->
                <ChatWindowHiddenMenu
                    class="o_ChatWindowManager_hiddenMenu"
                    chatWindowLocalIds="storeProps.computed.hidden.chatWindowLocalIds"
                    direction="direction"
                    offset="storeProps.computed.hidden.offset"
                    t-on-o-close-chat-window="_onCloseChatWindow"
                    t-on-o-select-chat-window="_onSelectChatWindow"
                />
            </t>
            <t t-set="visibleAmount" t-value="storeProps.computed.visible.length"/>
            <t t-foreach="orderedVisible" t-as="data" t-key="data.chatWindowLocalId">
                <ChatWindow
                    chatWindowLocalId="data.chatWindowLocalId"
                    dockDirection="direction"
                    dockOffset="data.offset"
                    hasCloseAsBackButton="storeProps.isMobile"
                    hasShiftLeft="!storeProps.isMobile and data_index !== 0"
                    hasShiftRight="!storeProps.isMobile and chatWindowShiftRight(data_index)"
                    isDocked="!storeProps.isMobile"
                    isExpandable="!storeProps.isMobile and data.chatWindowLocalId !== 'new_message'"
                    isFullscreen="storeProps.isMobile"
                    threadInitialScrollTop="storeProps.chatWindowInitialScrollTops[data.chatWindowLocalId]"
                    t-on-o-focus-next-chat-window="_onFocusNextChatWindow"
                    t-on-o-focus-previous-chat-window="_onFocusPreviousChatWindow"
                    t-on-o-select-thread="_onSelectThreadChatWindow"
                    t-ref="chatWindow_{{ data.chatWindowLocalId }}"
                />
            </t>
        </div>
    </t>

</templates>
