<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="mail.messaging.component.ChatWindow" owl="1">
        <div class="o_ChatWindow" tabindex="0"
            t-att-class="{
                'o-focused': chatWindow and chatWindow.isFocused,
                'o-folded': chatWindow and chatWindow.isFolded,
                'o-fullscreen': props.isFullscreen,
                'o-mobile': env.entities.Device.instance.isMobile,
                'o-new-message': chatWindow and chatWindow === env.entities.ChatWindow.newMessage,
            }" t-on-click="_onClick" t-on-keydown="_onKeydown" t-on-focusout="_onFocusout" t-att-data-chat-window="chatWindow ? chatWindow.localId : undefined" t-att-data-thread="chatWindow ? (chatWindow.thread ? chatWindow.thread.localId : '') : undefined"
        >
            <t t-if="chatWindow">
                <ChatWindowHeader
                    class="o_ChatWindow_header"
                    chatWindow="chatWindow.localId"
                    hasCloseAsBackButton="props.hasCloseAsBackButton"
                    isExpandable="props.isExpandable"
                    t-on-o-clicked="_onClickedHeader"
                />
                <t t-if="chatWindow.thread">
                    <ThreadViewer
                        class="o_ChatWindow_thread"
                        composerAttachmentsDetailsMode="'card'"
                        hasComposer="chatWindow.thread.model !== 'mail.box'"
                        hasComposerCurrentPartnerAvatar="false"
                        hasComposerSendButton="env.entities.Device.instance.isMobile"
                        hasSquashCloseMessages="chatWindow.thread.model !== 'mail.box'"
                        haveMessagesAuthorRedirect="chatWindow.thread.channel_type !== 'chat'"
                        threadViewer="chatWindow.threadViewer.localId"
                        t-on-focusin="_onFocusinThread"
                        t-ref="thread"
                    />
                </t>
                <t t-else="">
                    <div class="o_ChatWindow_newMessageForm">
                        <span class="o_ChatWindow_newMessageFormLabel">
                            To:
                        </span>
                        <AutocompleteInput
                            class="o_ChatWindow_newMessageFormInput"
                            isHtml="true"
                            placeholder="newMessageFormInputPlaceholder"
                            select="_onAutocompleteSelect"
                            source="_onAutocompleteSource"
                            t-ref="input"
                        />
                    </div>
                </t>
            </t>
        </div>
    </t>

</templates>
