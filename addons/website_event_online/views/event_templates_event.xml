<?xml version="1.0" encoding="utf-8"?>
<odoo>

<template id="event_layout_main" inherit_id="website_event.layout">
    <xpath expr="//div[@id='o_wevent_event_submenu']/ul" position="replace">
        <ul class="navbar-nav w-100" t-att-data-menu_name="editable and 'Event Menu'" t-att-data-content_menu_id="editable and event.menu_id.id">
            <t t-foreach="event.menu_id.child_id" t-as="submenu">
                <t t-if="'/register' not in submenu.clean_url()" t-call="website.submenu">
                    <t t-set="item_class" t-value="'nav-item'"/>
                    <t t-set="link_class" t-value="'nav-link'"/>
                </t>
            </t>
            <t t-foreach="event.menu_id.child_id" t-as="submenu">
                <t t-if="'/register' in submenu.clean_url()" t-call="website.submenu">
                    <t t-set="item_class" t-value="'nav-item ml-auto %s' % ('btn btn-primary p-0' if not event.is_participating else '')"/>
                    <t t-set="link_class" t-value="'nav-link'"/>
                </t>
            </t>
        </ul>
    </xpath>
</template>

<template id="events_list" inherit_id="website_event.events_list">
    <xpath expr="//t[@t-foreach='event.tag_ids']/span" position="replace">
        <span t-attf-class="badge mr8 #{'badge-primary' if tag in search_tags else 'badge-light'}  #{'o_tag_color_%s' % tag.color if tag.color else ''}">
            <span t-esc="tag.name"/>
        </span>
    </xpath>
</template>

<template id="event_countdown">
    <t t-call="website_event.layout">
        <section class="s_title pt48 pb48" data-vcss="001" data-snippet="s_title">
            <div class="container">
                <h1><t t-esc="event.name"/> starts in</h1>
            </div>
        </section>
        <section class="s_countdown pt48 pb48"
            data-display="dhms" data-end-action="redirect" data-size="275"
            t-att-data-end-time="datetime.datetime.now().timestamp() + int(remaining_time)"
            t-att-data-redirect-url="redirect_url"
            data-layout="circle" data-layout-background="none"
            data-progress-bar-style="surrounded" data-progress-bar-weight="thin"
            data-text-color="alpha" data-layout-background-color="400" data-progress-bar-color="alpha">
            <div class="container">
                <div class="s_countdown_canvas_wrapper text-center"/>
            </div>
        </section>
    </t>
</template>

<template id="display_timer" name="Display Timer Widget">
    <t t-set="start_countdown_display" t-value="bool(start_countdown_text) or start_countdown_display"/>
    <t t-set="start_countdown_time" t-value="datetime.datetime.now().timestamp() + int(start_remaining_time)"/>

    <div class="o_display_timer"
         t-att-data-display-class="display_class"
         t-att-data-end-countdown-time="datetime.datetime.now().timestamp() + int(end_remaining_time)"
         t-att-data-start-countdown-time="start_countdown_time"
         t-att-data-start-countdown-display="start_countdown_display"
         t-att-data-start-countdown-text="start_countdown_text"
         t-att-data-end-countdown-text="end_countdown_text">
        <t t-set="remaining_time" t-value="start_remaining_time if start_remaining_time else end_remaining_time"/>
        <span class="o_display_timer_countdown d-flex justify-content-center">
            <span class="o_countdown_text pr-1" t-esc="start_countdown_text if start_countdown_text else end_countdown_text if not start_countdown_display else ''"/>
            <div t-if="int(remaining_time) > 86400"
             class="o_countdown_metric_container"><span class="o_countdown_remaining o_timer_days pr-1">0</span><span class="o_countdown_metric pr-1">days</span></div>
            <div t-if="int(remaining_time) > 3600"
                 class="o_countdown_metric_container"><span class="o_countdown_remaining o_timer_hours">00</span><span class="o_countdown_metric">:</span></div>
            <div class="o_countdown_metric_container"><span class="o_countdown_remaining o_timer_minutes">00</span><span class="o_countdown_metric">:</span></div>
            <div class="o_countdown_metric_container"><span class="o_countdown_remaining o_timer_seconds">00</span><span class="o_countdown_metric"></span></div>
        </span>
    </div>
</template>

</odoo>
