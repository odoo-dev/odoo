<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>

<template id="report_followup_configurator" inherit_id="account.report_configurator" primary="True">
    <xpath expr="//style" position="replace">
    </xpath>
    <xpath expr="//div[@class='row mt32']" position="replace">
        <div class="row mt32">
            <div class="col-sm-3">
                <label for="partner">Partner :</label>
                <select name="partner" class="form-control">
                    <option t-if="'all' == context.partner" selected="selected" value="all">
                        All Partners
                    </option>
                    <option t-if="'all' != context.partner" value="all">
                        All Partners
                    </option>
                    <t t-foreach="context.get_partners()" t-as="p"> 
                        <option t-if="'all' != context.partner and p.id == int(context.partner)" selected="selected" t-att-value="p.id">
                            <t t-esc="p.name"></t>
                        </option>
                        <option t-if="'all' == context.partner or p.id != int(context.partner)" t-att-value="p.id">
                            <t t-esc="p.name"></t>
                        </option>
                    </t>   
                </select>
            </div>
        </div>
    </xpath>
</template>
<template id="report_followup_line" inherit_id="account.report_financial_line" primary="True">
    <xpath expr="//div[@class='dropdown']" position="replace">
        <div class="dropdown" t-if="a['type'] == 'invoice_id' and mode != 'print'">
            <a data-toggle="dropdown">
                <span style="font-style: italic; margin-left: 70px" t-att-class="' '.join([a['type'], str(a['id'])])">
                    <t t-esc="a.get('name')"/>
                </span>
                <span class="caret"></span>
            </a>
            <t t-call="account.report_financial_footnote_sup" />
            <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel" style="margin-left: 70px">
                <li role="presentation"><a role="menuitem" tabindex="-1" class="to_invoice">View Invoice</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" class="change_exp_date">Change expected payment date/note</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" class="add_footnote">Add Footnote</a></li>
            </ul>
        </div>
    </xpath>    
    <xpath expr="//td/t[@t-set='column']" position="after">
        <t t-set="tooltip" t-value="''" />
        <t t-if="column == 3 and a['type'] == 'invoice_id'"><t t-set="tooltip" t-value="c[1]" /><t t-set="c" t-value="c[0]" /></t>
    </xpath>
    <xpath expr="//span[@class='annotable']" position="attributes">
        <attribute name="data-toggle">tooltip</attribute>
        <attribute name="data-placement">bottom</attribute>
        <attribute name="t-att-title">tooltip</attribute>
    </xpath>
</template>
<template id="report_followup" inherit_id="account.report_financial" primary="True">
    <xpath expr="//t[@t-call='account.report_financial_line']" position="replace">
        <t t-call='account.report_followup_line' />
    </xpath>
    <xpath expr="//t[@t-call='account.report_configurator']" position="replace">
        <t t-call='account.report_followup_configurator' />
    </xpath>
    <xpath expr="//div[@id='footnoteModal']" position="after">
        <div t-if="mode != 'print'" class="modal fade" id="paymentDateModal" tabindex="-1" role="dialog" aria-labelledby="paymentDateLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&amp;times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="paymentDateLabel"></h4>
                    </div>
                    <div class="modal-body">
                        <form role="form">
                            <label for="expectedDate">Expected Payment Date</label>
                            <input type="date" class="form-control" name="expectedDate" id="expectedDate"></input>
                            <label for='internalNote'>Note</label>
                            <textarea name="internalNote" id="internalNote" rows='4' class="form-control" placeholder="Insert note here"></textarea>
                            <input type='hidden' id='target_id' />
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="savePaymentDate">Save</button> or <button type="button" class="btn btn-link" data-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </xpath>
    <xpath expr="//div[@class='dropdown']" position="replace">
        <div t-if="mode != 'print'" style="float: right; margin-bottom: 250px;">
            <a class="btn btn-default" href="?pdf" role="button">Print Letter</a>
            <button type="button" class="btn btn-primary" href="?email">Send by email</button>
        </div>
    </xpath>
</template>
</data>
</openerp>