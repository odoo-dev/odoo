<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Display of /pos/pay (the order of the if conditions matters)-->
    <template id="pay">
        <t t-call="portal.frontend_layout">
            <t t-set="page_title" t-value="'Payment'" />
            <t t-set="additional_title">
                <t t-esc="page_title" />
            </t>
            <div class="wrap">
                <div class="container">
                    <div class="row">
                        <div class="mt-4 col-lg-7">
                            <div t-if="not currency" class="alert alert-danger">
                                <strong>Error:</strong> The currency is missing or invalid. </div>
                            <div t-elif="not amount" class="alert alert-info">
                                There is nothing to pay.
                            </div>
                            <div t-elif="not payment_methods_sudo and not tokens_sudo" class="alert alert-danger">
                                <strong>No suitable payment method could be found.</strong><br/>
                                If you believe that it is an error, please contact the website
                                administrator.
                            </div>
                            <t t-else="">
                                <t t-call="pos_online_payment.pay_summary"/>
                                <t t-call="payment.form" />
                            </t>
                            <div class="col-md-4 offset-md-3 mt-2 ps-0" t-if="exit_route">
                                <a role="button"
                                    class="btn btn-secondary"
                                    t-att-href="exit_route">
                                    Cancel payment </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="pay_summary">
        <div class="o_cc o_cc2 row row-cols-1 row-cols-md-3 mx-0 py-2 rounded">
            <div class="col my-3">
                <label for="o_pos_summary_amount" class="d-block small text-muted">
                    Amount
                </label>
                <span id="o_pos_summary_amount"
                      t-out="amount"
                      t-options="{'widget': 'monetary', 'display_currency': currency}"
                      class="fs-4 fw-bold"
                />
            </div>
            <hr class="d-md-none m-0 text-300 opacity-100"/>
            <div class="o_payment_summary_left_separator col my-3">
                <label for="o_pos_summary_reference" class="d-block small text-muted">
                    Order Reference
                </label>
                <span id="o_pos_summary_reference" t-out="reference_prefix" class="fs-4 fw-bold"/>
            </div>
            <hr class="d-md-none m-0 text-300 opacity-100"/>
            <div class="o_payment_summary_left_separator col my-3">
                <label for="o_pos_summary_order_id" class="d-block small text-muted">
                    Order ID
                </label>
                <span id="o_pos_summary_order_id" t-out="pos_order_id" class="fs-4 fw-bold"/>
            </div>
        </div>
    </template>

    <!-- Display of /pos/pay/confirmation -->
    <template id="pay_confirmation">
        <t t-call="portal.frontend_layout">
            <t t-set="page_title" t-value="'Payment Confirmation'" />
            <t t-set="additional_title">
                <t t-esc="page_title" />
            </t>
            <div class="wrap">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-6">
                            <div>
                                <t t-if="state == 'error'">
                                    <div class="alert alert-danger">
                                        <strong>Error:</strong> There was a problem during the payment process. </div>
                                </t>
                                <t t-else="">
                                    <t t-call="payment.transaction_status" />
                                    <div class="mb-3 row">
                                        <t t-if="state == 'success'">
                                            <label for="form_amount" class="col-md-3 col-form-label" style="width: 30%;">
                                                Amount:
                                            </label>
                                            <span name="form_amount"
                                                class="col-md-9 col-form-label"
                                                t-esc="amount"
                                                t-options="{'widget': 'monetary', 'display_currency': currency}"
                                                style="width: 70%;" />
                                        </t>
                                        <label for="form_order_reference" class="col-md-3 col-form-label">
                                            Order Reference:
                                        </label>
                                        <span name="form_order_reference"
                                            class="col-md-9 col-form-label"
                                            t-esc="order_reference" />
                                        <label for="form_tx_reference" class="col-md-3 col-form-label">
                                            Transaction Reference:
                                        </label>
                                        <span name="form_tx_reference"
                                            class="col-md-9 col-form-label"
                                            t-esc="tx_reference" />
                                        <label for="form_order_id" class="col-md-3 col-form-label" style="width: 30%;">
                                            Order id:
                                        </label>
                                        <span name="form_order_id"
                                            class="col-md-9 col-form-label"
                                            t-esc="pos_order_id"
                                            style="width: 70%;" />
                                    </div>
                                </t>
                                <div class="col-md-4 offset-md-3 mt-2 ps-0" t-if="pay_route and state != 'success'">
                                    <a role="button"
                                        class="btn btn-secondary"
                                        t-att-href="pay_route">
                                        Try again </a>
                                </div>
                                <div class="col-md-4 offset-md-3 mt-2 ps-0" t-if="exit_route">
                                    <a role="button"
                                        class="btn btn-primary"
                                        t-att-href="exit_route">
                                        <t t-esc="'Continue' if state == 'success' else 'Cancel payment'" />
                                    </a>
                                </div>
                                <div class="col-md-5 text-muted" t-if="state == 'success'"> Processed by <t t-esc="provider_name" /></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

</odoo>
