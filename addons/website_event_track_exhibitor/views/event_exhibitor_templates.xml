<?xml version="1.0" encoding="utf-8"?>
<odoo>

<template id="event_exhibitors" name="Event Exhibitors">
    <t t-call="website_event.layout">
        <div class="o_wesponsor_index o_wesponsor_index_bg">
            <!-- Topbar -->
            <t t-call="website_event_track_exhibitor.exhibitors_topbar"/>
            <!-- Drag/Drop Area -->
            <div id="oe_structure_wesponsor_index_1" class="oe_structure"/>
            <!-- Content -->
            <div class="o_wevent_session_list">
                <div class="container">
                    <div class="row">
                        <t t-call="website_event_track_exhibitor.exhibitors_search"/>
                    </div>
                    <div class="row o_wesession_index_main my-5">
                        <t t-call="website_event_track_exhibitor.exhibitors_display"/>
                    </div>
                </div>
            </div>
            <!-- Drag/Drop Area -->
            <div id="oe_structure_wesponsor_index_2" class="oe_structure"/>
        </div>
    </t>
</template>

<!-- CONTENT: MAIN TEMPLATES -->

<!-- Exhibitors Main Display -->
<template id="exhibitors_display" name="Exhibitors Main Display">
    <!-- No exhibitors -->
    <t t-if="not sponsor_categories">
        <div class="col-12">
            <div class="h2 mb-3">No exhibitors found.</div>
            <div class="alert alert-info text-center" groups="event.group_event_manager">
                <p class="m-0">Add some exhibitors to get started !</p>
            </div>
        </div>
    </t>
    <!-- Cards -->
    <div class="col-12" t-call="website_event_track_exhibitor.exhibitors_display_cards"/>
</template>

<!-- Exhibitors: Cards-based display -->
<template id="exhibitors_display_cards" name="Exhibitors Cards">
    <div class="o_wesponsor_cards">
        <div t-foreach="sponsor_categories" t-as="sponsor_category" class="row mb-5">
            <div class="col-12">
                <h5 class="m-0 text-danger" t-esc="sponsor_category['sponsorship'].name"/>
                <hr class="mt-2 pb-1 mb-1"/>
            </div>
            <div t-foreach="sponsor_category['sponsors']" t-as="sponsor" class="col-md-6 col-lg-3 mb-4">
                <t t-call="website_event_track_exhibitor.exhibitor_card"/>
            </div>
        </div>
    </div>
</template>

<template id="exhibitor_card" name="Exhibitor Card">
    <a t-att-href="sponsor.website_url" class="text-decoration-none">
        <article t-att-class="'h-100 card border-0 shadow-sm o_wesponsor_card %s' % ('o_wesponsor_card_unpublished' if not sponsor.is_published else '')"
            itemscope="itemscope" itemtype="http://schema.org/Event">
            <div class="h-100 row no-gutters">
                <header class="overflow-hidden bg-secondary col-12 rounded-top">
                    <t t-set="sponsor_image" t-value="website.image_url(sponsor, 'image_256')"/>

                    <div t-if="sponsor.image_256" class="card-img-top"
                        t-attf-style="padding-top: 50%; background-image: url(#{sponsor_image}); background-size: cover; background-position:center"/>
                    <div t-else="" class="o_wslides_gradient card-img-top position-relative"
                        style="padding-top: 50%; opacity: 0.8">
                        <i class="fa fa-graduation-cap fa-2x mr-3 mb-3 position-absolute text-white-75" style="right:0; bottom: 0"/>
                    </div>
                </header>
                <div class="col-12">
                    <main class="card-body">
                        <!-- Title -->
                        <h5 class="card-title mt-0 mb-0 text-truncate">
                            <span t-field="sponsor.partner_name" itemprop="name"/>
                        </h5>
                        <!-- Catchy sentence -->
                        <span class="text-muted" t-esc="sponsor.subtitle"/>
                    </main>
                </div>
            </div>
        </article>
    </a>
</template>

<!-- TOPBAR: BASE NAVIGATION -->

<!-- Main topbar -->
<template id="exhibitors_topbar"
    name="Exhibitor Tools">
    <nav class="navbar navbar-light border-top shadow-sm d-print-none">
        <div class="container">
            <div class="row d-flex justify-content-between w-100 mr-0">
                <div class="col-lg-8 col-sm-12">
                    <ul class="o_wevent_index_topbar_filters nav"/>
                </div>
                <div class="col-lg-3 col-sm-12 d-flex align-items-center flex-wrap px16">
                    <t t-call="website_event.events_search_box">
                        <t t-set="_searches" t-value="searches"/>
                        <t t-set="_placeholder" t-value="'Search an exhibitor ...'"/>
                        <t t-set="clear_link" t-value="'/event/%s/exhibitors' % (slug(event))"/>
                    </t>
                </div>
            </div>
        </div>
    </nav>
</template>

<!-- Topbar: optional tags filters -->
<template id="exhibitors_topbar_country"
    inherit_id="website_event_track_exhibitor.exhibitors_topbar"
    name="Filter by Country"
    active="True"
    customize_show="True">
    <xpath expr="//ul[hasclass('o_wevent_index_topbar_filters')]" position="inside">
        <li class="nav-item dropdown mr-2 my-1">
            <a href="#" role="button" class="btn dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-folder-open"/>
                By Country
            </a>
            <div class="dropdown-menu">
                <t t-foreach="sponsor_countries" t-as="sponsor_country">
                    <a t-att-href="'/event/%s/exhibitors?%s' % (
                            slug(event),
                            keep_query('*', countries=str((search_countries - sponsor_country).ids if sponsor_country in search_countries else (sponsor_country | search_countries).ids))
                        )"
                        t-attf-class="dropdown-item d-flex align-items-center justify-content-between #{'active' if sponsor_country in search_countries else ''}">
                        <t t-esc="sponsor_country.name"/>
                    </a>
                </t>
            </div>
        </li>
    </xpath>
</template>

<template id="exhibitors_topbar_sponsorship"
    inherit_id="website_event_track_exhibitor.exhibitors_topbar"
    name="Filter by Sponsorship"
    active="True"
    customize_show="True">
    <xpath expr="//ul[hasclass('o_wevent_index_topbar_filters')]" position="inside">
        <li class="nav-item dropdown mr-2 my-1">
            <a href="#" role="button" class="btn dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-folder-open"/>
                By Sponsorship
            </a>
            <div class="dropdown-menu">
                <t t-foreach="sponsor_types" t-as="sponsor_type">
                    <a t-att-href="'/event/%s/exhibitors?%s' % (
                            slug(event),
                            keep_query('*', sponsorhips=str((search_sponsorhips - sponsor_type).ids if sponsor_type in search_sponsorhips else (sponsor_type | search_sponsorhips).ids))
                        )"
                        t-attf-class="dropdown-item d-flex align-items-center justify-content-between #{'active' if sponsor_type in search_sponsorhips else ''}">
                        <t t-esc="sponsor_type.name"/>
                    </a>
                </t>
            </div>
        </li>
    </xpath>
</template>

<!-- Searched tags -->
<template id="exhibitors_search" name="Exhibitors: search terms">
    <div class="d-flex align-items-center mt16">
        <t t-foreach="search_countries" t-as="country">
            <span class="align-items-baseline border d-inline-flex pl-2 rounded ml16 mb-2 bg-white">
                <i class="fa fa-tag mr-2 text-muted"/>
                <t t-esc="country.display_name"/>
                <a t-att-href="'/event?%s' % keep_query('*', tags=str((search_countries - country).ids))" class="btn border-0 py-1">&#215;</a>
            </span>
        </t>
    </div>
</template>

</odoo>
